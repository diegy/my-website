<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptCraft Pro - AIæç¤ºè¯ç”Ÿæˆå™¨</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --secondary: #8b5cf6;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --bg-dark: #0f172a;
            --bg-darker: #020617;
            --bg-card: #1e293b;
            --bg-card-hover: #263449;
            --bg-input: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #475569;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-darker);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container { max-width: 1400px; margin: 0 auto; padding: 24px; }

        /* Header */
        header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-darker) 100%);
            border-bottom: 1px solid var(--border);
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 12px;
        }

        .subtitle { color: var(--text-secondary); font-size: 1.1rem; }

        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 48px;
            padding: 20px;
            background: var(--bg-card);
            border-radius: 12px;
            margin: 24px 0;
        }

        .stat-item { text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--primary-light); }
        .stat-label { font-size: 0.75rem; color: var(--text-muted); }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 24px;
            margin-top: 24px;
        }

        @media (max-width: 1024px) {
            .main-layout { grid-template-columns: 1fr; }
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Form Elements */
        .form-group { margin-bottom: 16px; }
        
        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--text-secondary);
        }

        input, textarea, select {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.9375rem;
            transition: all 0.2s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        textarea { min-height: 120px; resize: vertical; }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 0.9375rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }

        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3); }

        .btn-secondary {
            background: var(--bg-input);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover { background: var(--bg-card-hover); }

        /* Output Section */
        .output-section {
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
            position: relative;
        }

        .output-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .output-title { font-weight: 600; color: var(--primary-light); }

        .output-actions { display: flex; gap: 8px; }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.75rem;
        }

        pre {
            background: var(--bg-darker);
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Feedback Section */
        .feedback-section { margin-top: 24px; }
        
        .star-rating {
            display: flex;
            gap: 8px;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .star { color: var(--text-muted); transition: color 0.2s; }
        .star:hover, .star.active { color: var(--warning); }

        .feedback-list { margin-top: 16px; }
        
        .feedback-item {
            background: var(--bg-dark);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .feedback-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .feedback-stars { color: var(--warning); }
        .feedback-time { font-size: 0.75rem; color: var(--text-muted); }
        .feedback-text { font-size: 0.875rem; color: var(--text-secondary); }

        /* Community Section */
        .community-prompt {
            background: var(--bg-dark);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 12px;
            border: 1px solid var(--border);
        }

        .community-prompt-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .community-prompt-title { font-weight: 600; }
        
        .community-prompt-actions {
            display: flex;
            gap: 12px;
        }

        .action-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .action-btn:hover { color: var(--primary-light); }

        /* A/B Test Section */
        .ab-test-section { margin-top: 16px; }
        
        .version-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-top: 12px;
        }

        @media (max-width: 768px) {
            .version-comparison { grid-template-columns: 1fr; }
        }

        .version-box {
            background: var(--bg-dark);
            padding: 16px;
            border-radius: 8px;
            border: 2px solid transparent;
        }

        .version-box.selected { border-color: var(--primary); }
        
        .version-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary-light);
            margin-bottom: 8px;
        }

        /* Onboarding Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .modal-overlay.active { opacity: 1; visibility: visible; }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .modal-overlay.active .modal { transform: scale(1); }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .modal-content { color: var(--text-secondary); margin-bottom: 24px; }

        .modal-steps {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
        }

        .step-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border);
        }

        .step-dot.active { background: var(--primary); }

        .modal-actions {
            display: flex;
            justify-content: space-between;
            gap: 12px;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateX(400px);
            transition: transform 0.3s;
            z-index: 1001;
        }

        .toast.show { transform: translateX(0); }

        .toast-success { border-left: 4px solid var(--success); }
        .toast-error { border-left: 4px solid var(--error); }

        /* Floating Feedback Button */
        .fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.4);
            transition: all 0.3s;
            z-index: 100;
        }

        .fab:hover { transform: scale(1.1); }

        /* Tags */
        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .tag {
            padding: 4px 12px;
            background: var(--bg-input);
            border-radius: 16px;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .tag-primary {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary-light);
        }
    </style>
</head>
<body>
    <!-- Onboarding Modal -->
    <div id="onboardingModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-title">ğŸ‘‹ æ¬¢è¿ä½¿ç”¨ PromptCraft Pro</div>
            <div class="modal-content" id="onboardingContent">
                æˆ‘ä»¬å°†é€šè¿‡å‡ ä¸ªç®€å•çš„æ­¥éª¤ï¼Œå¸®æ‚¨å¿«é€Ÿä¸Šæ‰‹è¿™ä¸ªå¼ºå¤§çš„AIæç¤ºè¯ç”Ÿæˆå·¥å…·ã€‚
            </div>
            <div class="modal-steps">
                <div class="step-dot active"></div>
                <div class="step-dot"></div>
                <div class="step-dot"></div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="skipOnboarding()">è·³è¿‡</button>
                <button class="btn btn-primary" onclick="nextOnboardingStep()">ä¸‹ä¸€æ­¥</button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedbackModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-title">ğŸ’¬ æ‚¨çš„åé¦ˆå¯¹æˆ‘ä»¬å¾ˆé‡è¦</div>
            <div class="modal-content">
                <div class="form-group">
                    <label>è¯„åˆ†</label>
                    <div class="star-rating" id="starRating">
                        <span class="star" data-rating="1">â­</span>
                        <span class="star" data-rating="2">â­</span>
                        <span class="star" data-rating="3">â­</span>
                        <span class="star" data-rating="4">â­</span>
                        <span class="star" data-rating="5">â­</span>
                    </div>
                </div>
                <div class="form-group">
                    <label>æ‚¨çš„å»ºè®®</label>
                    <textarea id="feedbackText" placeholder="è¯·å‘Šè¯‰æˆ‘ä»¬æ‚¨çš„ä½¿ç”¨ä½“éªŒ..."></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeFeedbackModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="submitFeedback()">æäº¤åé¦ˆ</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast">
        <span id="toastIcon">âœ…</span>
        <span id="toastMessage">æ“ä½œæˆåŠŸ</span>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="logo">PromptCraft Pro</div>
            <div class="subtitle">AIé©±åŠ¨çš„æç¤ºè¯ç”Ÿæˆä¸ä¼˜åŒ–å¹³å°</div>
        </div>
    </header>

    <!-- Stats Bar -->
    <div class="container">
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="totalPrompts">0</div>
                <div class="stat-label">ç”Ÿæˆæç¤ºè¯</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="avgRating">0.0</div>
                <div class="stat-label">å¹³å‡è¯„åˆ†</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="communityPrompts">0</div>
                <div class="stat-label">ç¤¾åŒºåˆ†äº«</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="main-layout">
            <!-- Left Sidebar: Templates -->
            <div class="left-sidebar">
                <div class="card">
                    <div class="card-title">ğŸ“‹ åœºæ™¯æ¨¡æ¿</div>
                    <div class="form-group">
                        <select id="templateSelect" onchange="loadTemplate()">
                            <option value="">é€‰æ‹©åœºæ™¯...</option>
                            <option value="writing">âœï¸ å†…å®¹åˆ›ä½œ</option>
                            <option value="coding">ğŸ’» ä»£ç ç”Ÿæˆ</option>
                            <option value="analysis">ğŸ“Š æ•°æ®åˆ†æ</option>
                            <option value="translation">ğŸŒ ç¿»è¯‘æ¶¦è‰²</option>
                            <option value="learning">ğŸ“š å­¦ä¹ è¾…å¯¼</option>
                            <option value="business">ğŸ’¼ å•†ä¸šæ–‡æ¡ˆ</option>
                        </select>
                    </div>
                    <div id="templateDescription" style="font-size: 0.875rem; color: var(--text-secondary);"></div>
                </div>

                <div class="card">
                    <div class="card-title">ğŸ·ï¸ å¸¸ç”¨æ ‡ç­¾</div>
                    <div class="tags">
                        <span class="tag tag-primary">#å°çº¢ä¹¦</span>
                        <span class="tag">#ç”µå•†</span>
                        <span class="tag">#è¥é”€</span>
                        <span class="tag">#æŠ€æœ¯</span>
                        <span class="tag">#åˆ›æ„</span>
                    </div>
                </div>

                <!-- Feedback Section -->
                <div class="card">
                    <div class="card-title">ğŸ’¬ ç”¨æˆ·åé¦ˆ</div>
                    <div class="feedback-list" id="feedbackList">
                        <!-- Feedback items will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Center: Main Generator -->
            <div class="center-content">
                <div class="card">
                    <div class="card-title">ğŸ¯ æç¤ºè¯ç”Ÿæˆå™¨</div>
                    
                    <div class="form-group">
                        <label>æ‚¨çš„éœ€æ±‚æè¿°</label>
                        <textarea id="userInput" placeholder="æè¿°æ‚¨æƒ³è¦å®ç°çš„ç›®æ ‡ï¼Œä¾‹å¦‚ï¼šå†™ä¸€ç¯‡å…³äºäººå·¥æ™ºèƒ½çš„å°çº¢ä¹¦æ–‡æ¡ˆ..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>é£æ ¼è°ƒæ€§</label>
                        <select id="styleSelect">
                            <option value="professional">ä¸“ä¸šä¸¥è°¨</option>
                            <option value="casual">è½»æ¾éšæ„</option>
                            <option value="creative">åˆ›æ„å‘æ•£</option>
                            <option value="academic">å­¦æœ¯è§„èŒƒ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>è¾“å‡ºé•¿åº¦</label>
                        <select id="lengthSelect">
                            <option value="short">ç®€çŸ­ï¼ˆ100å­—å†…ï¼‰</option>
                            <option value="medium">é€‚ä¸­ï¼ˆ300å­—å·¦å³ï¼‰</option>
                            <option value="long">è¯¦ç»†ï¼ˆ500å­—ä»¥ä¸Šï¼‰</option>
                        </select>
                    </div>

                    <button class="btn btn-primary" onclick="generatePrompt()" style="width: 100%;">
                        âœ¨ ç”Ÿæˆæç¤ºè¯
                    </button>

                    <!-- A/B Test Section -->
                    <div class="ab-test-section" id="abTestSection" style="display: none;">
                        <div class="card-title">ğŸ”„ A/B ç‰ˆæœ¬å¯¹æ¯”</div>
                        <div class="version-comparison">
                            <div class="version-box selected" id="versionA" onclick="selectVersion('A')">
                                <div class="version-label">ç‰ˆæœ¬ A</div>
                                <pre id="versionAContent"></pre>
                            </div>
                            <div class="version-box" id="versionB" onclick="selectVersion('B')">
                                <div class="version-label">ç‰ˆæœ¬ B</div>
                                <pre id="versionBContent"></pre>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 12px;">
                            <button class="btn btn-secondary btn-small" onclick="generateAlternative()">ğŸ”„ ç”Ÿæˆæ›¿ä»£ç‰ˆæœ¬</button>
                        </div>
                    </div>

                    <!-- Output Section -->
                    <div class="output-section" id="outputSection" style="display: none;">
                        <div class="output-header">
                            <span class="output-title">ğŸ“ ç”Ÿæˆçš„æç¤ºè¯</span>
                            <div class="output-actions">
                                <button class="btn btn-secondary btn-small" onclick="copyOutput()">ğŸ“‹ å¤åˆ¶</button>
                                <button class="btn btn-secondary btn-small" onclick="shareToCommunity()">ğŸ“¤ åˆ†äº«</button>
                            </div>
                        </div>
                        <pre id="outputContent"></pre>
                    </div>
                </div>
            </div>

            <!-- Right Sidebar: Community -->
            <div class="right-sidebar">
                <div class="card">
                    <div class="card-title">ğŸŒŸ ç¤¾åŒºç²¾é€‰</div>
                    <div id="communityList">
                        <!-- Community prompts will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Feedback Button -->
    <button class="fab" onclick="openFeedbackModal()">ğŸ’¬</button>

    <script>
        // Data Storage
        const storage = {
            get: (key) => {
                try { return JSON.parse(localStorage.getItem(key)) || []; } 
                catch { return []; }
            },
            set: (key, value) => localStorage.setItem(key, JSON.stringify(value))
        };

        // Initialize data
        let feedbacks = storage.get('promptcraft_feedbacks');
        let communityPrompts = storage.get('promptcraft_community');
        let stats = storage.get('promptcraft_stats') || { total: 0, ratings: [] };

        // Onboarding
        let onboardingStep = 0;
        const onboardingSteps = [
            { title: 'ğŸ‘‹ æ¬¢è¿ä½¿ç”¨', content: 'æˆ‘ä»¬å°†é€šè¿‡å‡ ä¸ªç®€å•çš„æ­¥éª¤ï¼Œå¸®æ‚¨å¿«é€Ÿä¸Šæ‰‹è¿™ä¸ªå¼ºå¤§çš„AIæç¤ºè¯ç”Ÿæˆå·¥å…·ã€‚' },
            { title: 'ğŸ“ è¾“å…¥éœ€æ±‚', content: 'åœ¨å·¦ä¾§é€‰æ‹©åœºæ™¯æ¨¡æ¿ï¼Œæˆ–åœ¨ä¸­é—´è¾“å…¥æ‚¨çš„å…·ä½“éœ€æ±‚æè¿°ã€‚' },
            { title: 'âœ¨ ç”Ÿæˆä¼˜åŒ–', content: 'ç‚¹å‡»ç”ŸæˆæŒ‰é’®ï¼ŒAIå°†ä¸ºæ‚¨åˆ›å»ºä¸“ä¸šçš„æç¤ºè¯ã€‚ä½¿ç”¨A/Bæµ‹è¯•å¯¹æ¯”ä¸åŒç‰ˆæœ¬ã€‚' },
            { title: 'ğŸ¤ ç¤¾åŒºäº’åŠ¨', content: 'å°†ä¼˜ç§€çš„æç¤ºè¯åˆ†äº«åˆ°ç¤¾åŒºï¼Œæˆ–æµè§ˆä»–äººçš„åˆ›æ„è·å–çµæ„Ÿã€‚' }
        ];

        function checkOnboarding() {
            if (!localStorage.getItem('promptcraft_onboarding')) {
                document.getElementById('onboardingModal').classList.add('active');
            }
        }

        function nextOnboardingStep() {
            onboardingStep++;
            if (onboardingStep >= onboardingSteps.length) {
                completeOnboarding();
                return;
            }
            updateOnboardingUI();
        }

        function updateOnboardingUI() {
            const step = onboardingSteps[onboardingStep];
            document.querySelector('.modal-title').textContent = step.title;
            document.getElementById('onboardingContent').textContent = step.content;
            document.querySelectorAll('.step-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i <= onboardingStep);
            });
        }

        function skipOnboarding() {
            completeOnboarding();
        }

        function completeOnboarding() {
            localStorage.setItem('promptcraft_onboarding', 'true');
            document.getElementById('onboardingModal').classList.remove('active');
            showToast('âœ…', 'æ¬¢è¿ä½¿ç”¨ PromptCraft Proï¼');
        }

        // Template System
        const templates = {
            writing: { desc: 'é€‚ç”¨äºæ–‡ç« ã€æ–‡æ¡ˆã€æ•…äº‹ç­‰å†…å®¹åˆ›ä½œåœºæ™¯', example: 'å†™ä¸€ç¯‡å…³äº[ä¸»é¢˜]çš„[ç±»å‹]æ–‡ç« ï¼Œé£æ ¼[é£æ ¼]ï¼Œå­—æ•°çº¦[å­—æ•°]å­—ã€‚' },
            coding: { desc: 'é€‚ç”¨äºä»£ç ç”Ÿæˆã€è°ƒè¯•ã€ä¼˜åŒ–ç­‰æŠ€æœ¯åœºæ™¯', example: 'è¯·ç”¨[è¯­è¨€]ç¼–å†™ä¸€ä¸ª[åŠŸèƒ½]çš„ä»£ç ï¼Œè¦æ±‚[è¦æ±‚]ã€‚' },
            analysis: { desc: 'é€‚ç”¨äºæ•°æ®åˆ†æã€æŠ¥å‘Šç”Ÿæˆç­‰å•†ä¸šåœºæ™¯', example: 'åˆ†æä»¥ä¸‹æ•°æ®ï¼Œç»™å‡º[åˆ†æç±»å‹]ç»“è®ºï¼š[æ•°æ®å†…å®¹]' },
            translation: { desc: 'é€‚ç”¨äºå¤šè¯­è¨€ç¿»è¯‘ã€æ¶¦è‰²ç­‰è¯­è¨€å¤„ç†åœºæ™¯', example: 'å°†ä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆ[ç›®æ ‡è¯­è¨€]ï¼Œä¿æŒ[é£æ ¼]é£æ ¼ï¼š[å†…å®¹]' },
            learning: { desc: 'é€‚ç”¨äºçŸ¥è¯†å­¦ä¹ ã€æ¦‚å¿µè§£é‡Šç­‰æ•™è‚²åœºæ™¯', example: 'ç”¨ç®€å•æ˜“æ‡‚çš„æ–¹å¼è§£é‡Š[æ¦‚å¿µ]ï¼Œé€‚åˆ[å—ä¼—]ç†è§£ã€‚' },
            business: { desc: 'é€‚ç”¨äºå•†ä¸šè®¡åˆ’ã€è¥é”€æ–‡æ¡ˆç­‰å•†ä¸šåœºæ™¯', example: 'ä¸º[äº§å“/æœåŠ¡]æ’°å†™ä¸€ä»½[ç±»å‹]æ–‡æ¡ˆï¼Œçªå‡º[å–ç‚¹]ã€‚' }
        };

        function loadTemplate() {
            const template = document.getElementById('templateSelect').value;
            if (templates[template]) {
                document.getElementById('templateDescription').textContent = templates[template].desc;
                document.getElementById('userInput').placeholder = `ç¤ºä¾‹ï¼š${templates[template].example}`;
            }
        }

        // Prompt Generation
        function generatePrompt() {
            const input = document.getElementById('userInput').value;
            const style = document.getElementById('styleSelect').value;
            const length = document.getElementById('lengthSelect').value;

            if (!input.trim()) {
                showToast('âš ï¸', 'è¯·è¾“å…¥éœ€æ±‚æè¿°');
                return;
            }

            // Generate prompt based on inputs
            const generatedPrompt = generatePromptText(input, style, length);
            
            document.getElementById('outputContent').textContent = generatedPrompt;
            document.getElementById('outputSection').style.display = 'block';
            
            // Update stats
            stats.total++;
            storage.set('promptcraft_stats', stats);
            updateStats();

            showToast('âœ…', 'æç¤ºè¯ç”ŸæˆæˆåŠŸï¼');
        }

        function generatePromptText(input, style, length) {
            const styleMap = {
                professional: 'ä¸“ä¸šã€ä¸¥è°¨ã€é€»è¾‘æ¸…æ™°',
                casual: 'è½»æ¾ã€è‡ªç„¶ã€é€šä¿—æ˜“æ‡‚',
                creative: 'å¯Œæœ‰åˆ›æ„ã€ç”ŸåŠ¨å½¢è±¡ã€å¼•äººå…¥èƒœ',
                academic: 'å­¦æœ¯è§„èŒƒã€è®ºè¯ä¸¥å¯†ã€å¼•ç”¨å‡†ç¡®'
            };

            const lengthMap = {
                short: 'ç®€æ´æ˜äº†ï¼Œæ§åˆ¶åœ¨100å­—ä»¥å†…',
                medium: 'å†…å®¹å……å®ï¼Œçº¦300å­—å·¦å³',
                long: 'è¯¦ç»†å…¨é¢ï¼Œ500å­—ä»¥ä¸Š'
            };

            return `ã€è§’è‰²è®¾å®šã€‘
ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„AIåŠ©æ‰‹ï¼Œæ“…é•¿æ ¹æ®ç”¨æˆ·éœ€æ±‚ç”Ÿæˆé«˜è´¨é‡çš„æç¤ºè¯ã€‚

ã€ä»»åŠ¡æè¿°ã€‘
${input}

ã€è¾“å‡ºè¦æ±‚ã€‘
1. é£æ ¼è¦æ±‚ï¼š${styleMap[style] || styleMap.professional}
2. é•¿åº¦è¦æ±‚ï¼š${lengthMap[length] || lengthMap.medium}
3. ç»“æ„æ¸…æ™°ï¼Œé‡ç‚¹çªå‡º
4. è¯­è¨€æµç•…ï¼Œæ˜“äºç†è§£

ã€å‚è€ƒæ¡†æ¶ã€‘
- èƒŒæ™¯è¯´æ˜ï¼šç®€è¦ä»‹ç»ä»»åŠ¡èƒŒæ™¯
- å…·ä½“æŒ‡ä»¤ï¼šè¯¦ç»†æè¿°éœ€è¦å®Œæˆçš„å·¥ä½œ
- çº¦æŸæ¡ä»¶ï¼šåˆ—å‡ºä»»ä½•é™åˆ¶æˆ–è¦æ±‚
- æœŸæœ›è¾“å‡ºï¼šè¯´æ˜é¢„æœŸçš„ç»“æœæ ¼å¼

è¯·æ ¹æ®ä»¥ä¸Šè¦æ±‚ï¼Œç”Ÿæˆç¬¦åˆéœ€æ±‚çš„æç¤ºè¯ã€‚`;
        }

        // A/B Testing
        let currentVersion = 'A';
        let versionAContent = '';
        let versionBContent = '';

        function generateAlternative() {
            const input = document.getElementById('userInput').value;
            const style = document.getElementById('styleSelect').value;
            const length = document.getElementById('lengthSelect').value;

            if (!input.trim()) {
                showToast('âš ï¸', 'è¯·å…ˆç”Ÿæˆç¬¬ä¸€ä¸ªç‰ˆæœ¬');
                return;
            }

            // Generate alternative version
            const altPrompt = generateAlternativeText(input, style, length);
            
            versionAContent = document.getElementById('outputContent').textContent;
            versionBContent = altPrompt;

            document.getElementById('versionAContent').textContent = versionAContent;
            document.getElementById('versionBContent').textContent = versionBContent;
            document.getElementById('abTestSection').style.display = 'block';

            showToast('âœ…', 'æ›¿ä»£ç‰ˆæœ¬å·²ç”Ÿæˆï¼');
        }

        function generateAlternativeText(input, style, length) {
            // Alternative generation logic
            return `ã€ä¼˜åŒ–ç‰ˆæœ¬Bã€‘
åŸºäºæ‚¨çš„éœ€æ±‚ï¼š${input}

ã€å¢å¼ºç­–ç•¥ã€‘
1. é‡‡ç”¨${style === 'creative' ? 'æ›´åˆ›æ–°çš„' : 'æ›´ç³»ç»Ÿçš„'}è¡¨è¾¾æ–¹å¼
2. å¢åŠ å…·ä½“ç¤ºä¾‹å’Œåœºæ™¯è¯´æ˜
3. ä¼˜åŒ–ç»“æ„ï¼Œä½¿å…¶æ›´æ˜“äºAIç†è§£å’Œæ‰§è¡Œ

ã€è¯¦ç»†æŒ‡ä»¤ã€‘
è¯·æ ¹æ®ä»¥ä¸‹ä¼˜åŒ–åçš„æç¤ºè¯æ‰§è¡Œä»»åŠ¡ï¼š

èƒŒæ™¯ï¼š${input}
ç›®æ ‡ï¼šç”Ÿæˆé«˜è´¨é‡ã€ç¬¦åˆè¦æ±‚çš„è¾“å‡º
æ–¹æ³•ï¼šåˆ†æ­¥éª¤ã€ç»“æ„åŒ–å¤„ç†
è¾“å‡ºï¼šç¡®ä¿${length === 'short' ? 'ç®€æ´' : length === 'long' ? 'è¯¦å°½' : 'å¹³è¡¡'}çš„å†…å®¹å‘ˆç°

è¯·å¼€å§‹ç”Ÿæˆã€‚`;
        }

        function selectVersion(version) {
            currentVersion = version;
            document.getElementById('versionA').classList.toggle('selected', version === 'A');
            document.getElementById('versionB').classList.toggle('selected', version === 'B');
            
            const selectedContent = version === 'A' ? versionAContent : versionBContent;
            document.getElementById('outputContent').textContent = selectedContent;
            
            showToast('âœ…', `å·²é€‰æ‹©ç‰ˆæœ¬ ${version}`);
        }

        // Feedback System
        let currentRating = 0;

        function openFeedbackModal() {
            document.getElementById('feedbackModal').classList.add('active');
            currentRating = 0;
            updateStarDisplay();
        }

        function closeFeedbackModal() {
            document.getElementById('feedbackModal').classList.remove('active');
        }

        function updateStarDisplay() {
            document.querySelectorAll('.star').forEach((star, i) => {
                star.classList.toggle('active', i < currentRating);
            });
        }

        document.querySelectorAll('.star').forEach(star => {
            star.addEventListener('click', () => {
                currentRating = parseInt(star.dataset.rating);
                updateStarDisplay();
            });
        });

        function submitFeedback() {
            const text = document.getElementById('feedbackText').value;
            
            if (currentRating === 0) {
                showToast('âš ï¸', 'è¯·é€‰æ‹©è¯„åˆ†');
                return;
            }

            const feedback = {
                rating: currentRating,
                text: text,
                time: new Date().toLocaleString('zh-CN')
            };

            feedbacks.unshift(feedback);
            storage.set('promptcraft_feedbacks', feedbacks);
            
            stats.ratings.push(currentRating);
            storage.set('promptcraft_stats', stats);

            renderFeedbacks();
            updateStats();
            closeFeedbackModal();
            
            document.getElementById('feedbackText').value = '';
            currentRating = 0;
            updateStarDisplay();

            showToast('âœ…', 'æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼');
        }

        function renderFeedbacks() {
            const list = document.getElementById('feedbackList');
            const recent = feedbacks.slice(0, 3);
            
            list.innerHTML = recent.map(f => `
                <div class="feedback-item">
                    <div class="feedback-header">
                        <span class="feedback-stars">${'â­'.repeat(f.rating)}</span>
                        <span class="feedback-time">${f.time}</span>
                    </div>
                    <div class="feedback-text">${f.text || 'ç”¨æˆ·æœªå¡«å†™æ–‡å­—åé¦ˆ'}</div>
                </div>
            `).join('') || '<div style="color: var(--text-muted); font-size: 0.875rem;">æš‚æ— åé¦ˆ</div>';
        }

        // Community System
        function shareToCommunity() {
            const content = document.getElementById('outputContent').textContent;
            if (!content) {
                showToast('âš ï¸', 'è¯·å…ˆç”Ÿæˆæç¤ºè¯');
                return;
            }

            const prompt = {
                title: document.getElementById('userInput').value.slice(0, 30) + '...',
                content: content,
                author: 'åŒ¿åç”¨æˆ·',
                likes: 0,
                time: new Date().toLocaleString('zh-CN')
            };

            communityPrompts.unshift(prompt);
            storage.set('promptcraft_community', communityPrompts);
            
            renderCommunity();
            updateStats();
            
            showToast('âœ…', 'å·²åˆ†äº«åˆ°ç¤¾åŒºï¼');
        }

        function renderCommunity() {
            const list = document.getElementById('communityList');
            const recent = communityPrompts.slice(0, 5);
            
            list.innerHTML = recent.map((p, i) => `
                <div class="community-prompt">
                    <div class="community-prompt-header">
                        <span class="community-prompt-title">${p.title}</span>
                    </div>
                    <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 8px;">
                        ${p.author} Â· ${p.time}
                    </div>
                    <div class="community-prompt-actions">
                        <button class="action-btn" onclick="likePrompt(${i})">
                            ğŸ‘ ${p.likes}
                        </button>
                        <button class="action-btn" onclick="usePrompt(${i})">
                            ğŸ“‹ ä½¿ç”¨
                        </button>
                    </div>
                </div>
            `).join('') || '<div style="color: var(--text-muted); font-size: 0.875rem;">æš‚æ— ç¤¾åŒºåˆ†äº«</div>';
        }

        function likePrompt(index) {
            communityPrompts[index].likes++;
            storage.set('promptcraft_community', communityPrompts);
            renderCommunity();
            showToast('â¤ï¸', 'ç‚¹èµæˆåŠŸï¼');
        }

        function usePrompt(index) {
            const prompt = communityPrompts[index];
            document.getElementById('outputContent').textContent = prompt.content;
            document.getElementById('outputSection').style.display = 'block';
            showToast('âœ…', 'å·²åŠ è½½åˆ°ç¼–è¾‘å™¨');
        }

        // Utility Functions
        function copyOutput() {
            const content = document.getElementById('outputContent').textContent;
            navigator.clipboard.writeText(content).then(() => {
                showToast('ğŸ“‹', 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            });
        }

        function showToast(icon, message) {
            document.getElementById('toastIcon').textContent = icon;
            document.getElementById('toastMessage').textContent = message;
            document.getElementById('toast').classList.add('show');
            
            setTimeout(() => {
                document.getElementById('toast').classList.remove('show');
            }, 3000);
        }

        function updateStats() {
            document.getElementById('totalPrompts').textContent = stats.total;
            document.getElementById('communityPrompts').textContent = communityPrompts.length;
            
            const avg = stats.ratings.length > 0 
                ? (stats.ratings.reduce((a, b) => a + b, 0) / stats.ratings.length).toFixed(1)
                : '0.0';
            document.getElementById('avgRating').textContent = avg;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            checkOnboarding();
            renderFeedbacks();
            renderCommunity();
            updateStats();
        });
    </script>
</body>
</html>
